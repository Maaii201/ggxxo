<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Galeria Supabase</title>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    .gallery { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
    .item { background: #f0f0f0; padding: 10px; border-radius: 8px; }
    img, video { max-width: 100%; border-radius: 8px; }
    .download { display: block; margin-top: 8px; color: white; background: #0077ff; padding: 6px; border-radius: 4px; text-decoration: none; }
  </style>
</head>
<body>
  <h1>Minha Galeria</h1>
  <div class="gallery" id="gallery"></div>

  <script>
    const SUPABASE_URL = 'https://bfdpbayrtpuzzjgraxpq.supabase.co';
    const SUPABASE_ANON_KEY = 'yJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJmZHBiYXlydHB1enpqZ3JheHBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA5Nzg5NDQsImV4cCI6MjA3NjU1NDk0NH0.95UvUyAHZYDYcTx7-63seHZXgcJ4P3LfQpylnJnGal8';
    const BUCKET_NAME = 'midias'; // nome do seu bucket
    const PASTAS = ['fotos', 'videos', 'gifs']; // ajuste conforme seu uso

    const { createClient } = supabase;
    const supabaseClient = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    async function listarArquivos(pasta) {
      const { data, error } = await supabaseClient
        .storage
        .from(BUCKET_NAME)
        .list(pasta, { limit: 100 });

      if (error) {
        console.error('Erro ao listar arquivos:', error.message);
        return [];
      }
      return data.map(item => ({ ...item, pasta }));
    }

    function criarURL(pasta, nome) {
      return `${SUPABASE_URL}/storage/v1/object/public/${BUCKET_NAME}/${pasta}/${nome}`;
    }

    function exibirArquivo(arquivo) {
      const url = criarURL(arquivo.pasta, arquivo.name);
      const ext = arquivo.name.split('.').pop().toLowerCase();

      const div = document.createElement('div');
      div.className = 'item';

      if (['jpg', 'jpeg', 'png', 'gif', 'webp'].includes(ext)) {
        div.innerHTML = `<img src="${url}" alt="${arquivo.name}"><a class="download" href="${url}" download>Baixar</a>`;
      } else if (['mp4', 'webm'].includes(ext)) {
        div.innerHTML = `<video src="${url}" controls></video><a class="download" href="${url}" download>Baixar</a>`;
      } else {
        div.innerHTML = `<p>${arquivo.name}</p><a class="download" href="${url}" download>Baixar</a>`;
      }

      document.getElementById('gallery').appendChild(div);
    }

    async function carregarGaleria() {
      for (const pasta of PASTAS) {
        const arquivos = await listarArquivos(pasta);
        arquivos.forEach(exibirArquivo);
      }
    }

    carregarGaleria();
  </script>
</body>
</html>

